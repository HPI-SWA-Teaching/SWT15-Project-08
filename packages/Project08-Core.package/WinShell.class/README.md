This is mostly copied from ExternalWebBrowser and the Win32 FFI example